네트워크는 여러 개의 네트워크 기기를 기반으로 구축된다 
# 네트워크 기기의 처리 범위
| 계층          | 대표 기기        |     |
| ----------- | ------------ | -------- |
| L7 (애플리케이션) | L7 스위치       | 내용 기반 라우팅, 로드밸런싱 |
| L4 (전송)     | L4 스위치       | 포트 기반 로드밸런싱   |
| L3 (인터넷)    | 라우터, L3 스위치  | IP 라우팅   |
| L2 (데이터 링크) | L2 스위치, 브리지  | MAC 주소 기반 스위칭  |
| L1 (물리)     | NIC, 리피터, AP | 신호 증폭, 전송 매체 연결   |
- 네트워크 기기는 **OSI 계층별로 처리 가능한 정보의 범위가 정확히 정해져 있다.**
- 그리고 **상위 계층 기기는 하위 계층 기능을 포함하지만, 하위 계층 기기는 상위 계층을 처리할 수 없다.**
- 즉:
  - **L7 스위치 → L1~L7 모두 처리 가능**
  - **L3 스위치 → L1~ L3 처리 가능 (L4 ~L7 불가능)**
  - **AP → 물리 신호(L1)만 처리 (L2 이상 불가능)**
# 애플리케이션 계층을 처리하는 기기
## L7 스위치 (Application Switch)
<img width="598" height="306" alt="image" src="https://github.com/user-attachments/assets/78cb8cbe-9b12-4a1d-850b-5acad378f980" />

> 애플리케이션 정보를 분석해 트래픽을 분산하는 장치
- 여러 장비를 연결하여 데이터 통신 흐름을 중재
- 클라이언트 요청을 여러 서버로 나눠 서버 부하를 줄임
- URL/쿠키 기반 라우팅
- 불필요한 외부 데이터, 바이러스 등 필터링
- 애플리케이션 수준 트래픽 모니터링 가능
- 헬스체크를 통해 장애 서버는 자동으로 트래픽 분산 대상에서 제외
### L4 스위치와 L7 스위치 차이 (로드 밸런서)
| 구분    | L4 스위치       | L7 스위치                     |
| ----- | ------------ | -------------------------- |
| 기준    | IP + Port    | HTTP 헤더, 쿠키, URL, 패턴       |
| 계층    | 전송 계층        | 애플리케이션 계층                  |
| 사용 경우 | 단순 트래픽 분산    | 특정 서버로 정교한 트래픽 분산          |
| 예     | 서버1 ↔ 서버2 균등 | 이미지 요청은 서버 A, API 요청은 서버 B |
- L4 = 포트 기반 분산
- L7 = 내용 기반 분산(가장 정교함)
#### L4 스위치
- 전송 계층 기반 라우팅
- **IP + Port** 정보만 보고 트래픽 분산
- HTTP 메시지(헤더, 쿠키, URL)를 읽을 수 없음
- 스트리밍·게임 등 **단순 고속 처리**에 적합 (라이브 방송 말고 넷플릭스 같은거) 
- AWS 대응: **NLB(Network Load Balancer)**
#### L7 스위치
- 애플리케이션 계층 기반 라우팅
- **URL, 쿠키, HTTP 헤더, Host, Path** 등 분석하여 분산
- 콘텐츠 기반 분기 가능
- 웹/API처럼 **요청 의미를 분석해야 하는 서비스**에 적합
- AWS 대응: **ALB(Application Load Balancer)**
### 헬스 체크
> 로드밸런서(L4/L7)가 서버가 정상인지 반복적으로 확인하는 기능
- L4 헬스 체크
  - TCP 기반 확인
  - 예: TCP 연결(3-way handshake)이 정상적으로 되면 정상
- L7 헬스 체크
  - HTTP 기반 확인
  - 예: `/health` 요청에 200 OK가 오면 정상
### 로드밸런서를 이용한 서버 이중화
> 로드밸런서는 서버 장애 시 자동으로 정상 서버로 우회시킴
- 로드밸런서는 여러 서버를 묶어 하나의 가상 IP(VIP) 로 제공하고,
- 클라이언트는 이 VIP로 접속한다.
- 뒤에서는 로드밸런서가 정상 서버만 골라 트래픽을 분산한다.
#### 예시
<img width="567" height="423" alt="image" src="https://github.com/user-attachments/assets/6e797a12-3ecd-4ab0-ac80-4ab3b5b06771" />

1. 사용자 → VIP(0.0.0.12010)로 접속
2. 로드밸런서 → 정상 서버(0.0.0.12011, 0.0.0.12012)에 분산
3. 한 서버가 죽으면(예: 0.0.0.12011), 헬스 체크 결과에 따라 자동으로 제외
4. 남은 정상 서버만으로 서비스 계속 제공
# 인터넷 계층을 처리하는 기기
- 라우터 : 소프트웨어 기반 라우팅, 느림, 비쌈, 대신 고급 라우팅 
- L3 스위치 : 하드웨어 기반 라우팅, 빠름, 저렴
## 라우터
<img width="478" height="321" alt="image" src="https://github.com/user-attachments/assets/153ec68c-bd16-47d6-abc7-7d98de62764e" />

> 네트워크와 네트워크를 연결하고, 패킷을 최적 경로로 보내주는 L3 장비
- 다른 네트워크 간 데이터 전달
- 목적지IP 기준 경로 선택(라우팅 테이블 기반) 
- 패킷을 최소 비용·최단 경로로 전달
## L3 스위치
> L2 스위치 기능 + 라우팅 기능(IP 기반) 을 동시에 가진 장비

| 구분         | L2 스위치              | L3 스위치                 |
| ---------- | ------------------- | ---------------------- |
| 참조 테이블     | MAC 주소 테이블          | 라우팅 테이블                |
| 처리 단위(PDU) | 이더넷 프레임(L2)         | IP 패킷(L3)              |
| 참조 주소      | MAC 주소              | IP 주소                  |
| 주요 역할      | 같은 네트워크(LAN) 내부 스위칭 | 서로 다른 네트워크(VLAN 간 라우팅) |

# 데이터 링크 계층을 처리하는 기기
## L2 스위치
<img width="275" height="163" alt="image" src="https://github.com/user-attachments/assets/d7c4b541-5315-49d5-90d1-5a14746ddf58" />

- MAC 주소 기반 스위칭
- 같은 네트워크(LAN) 내에서만 통신 (IP 기반 라우팅 불가)
- 브로드캐스트 도메인 하나
- 들어온 프레임의 출발지 MAC 주소를 테이블에 저장
- 목적지 MAC이
  - 테이블에 있으면: 해당 포트로 전송
  - 없으면: 전체 포트로 브로드캐스트(Flooding)
## 브리지
# 물리 계층을 처리하는 기기
## NIC
## 리피터
## AP
