# 개요
- **인터넷 프로토콜 스위트(Internet Protocol Suite)** = 인터넷에서 컴퓨터들이 서로 정보를 주고받을 때 사용하는 **프로토콜의 집합**이다.
- 이를 설명하는 모델이 두 가지가 있다:
  - **TCP/IP 4계층 모델**
  - **OSI 7계층 모델**
- 여기서는 **TCP/IP 모델**을 중심으로 설명한다.
# 계층 구조
- <img width="506" height="426" alt="image" src="https://github.com/user-attachments/assets/8276df12-7333-4bb5-b60f-564b4e9b99eb" />
- <img width="473" height="412" alt="image" src="https://github.com/user-attachments/assets/7e861017-b704-4db6-a66b-a111e0751b58" />

- 각 계층은 **독립적**으로 동작하면서 위·아래 계층과 협력한다
  - 독립적이다 : TCP를 UDP로 바꾸었다고 인터넷 웹 브라우저를 재설치해야되고 그러지 않는다
- OSI 7계층
  - 애플리케이션 계층 → 애플리케이션/프레젠테이션/세션 계층
  - 인터넷 계층 → 네트워크 계층
  - 링크 계층 → 데이터 링크/물리 계층
## 애플리케이션 계층
- 임무: 사용자와 가장 가까운 계층. 실제 ‘서비스’가 동작하는 영역.
- 대표 프로토콜: HTTP, HTTPS, FTP, SMTP, DNS, SSH
- 데이터 단위: 메시지(Message)
> 즉, 브라우저가 “GET /index.html”을 보낼 때 이 계층에서 시작된다.
> 여기서 만들어진 메시지가 아래 계층으로 ‘캡슐화’되어 내려간다
## 전송 계층
- 임무: 프로세스 간 통신을 담당. (IP는 호스트 간, TCP/UDP는 프로세스 간)
- 대표 프로토콜: TCP, UDP
- 데이터 단위: 세그먼트(Segment, TCP) / 데이터그램(Datagram, UDP)
### 가상 회선 패킷 교환 방식
<img width="753" height="546" alt="image" src="https://github.com/user-attachments/assets/6dd57131-6d0d-4010-ab6e-f2f507fc28fb" />

> 통신 시작 시 경로를 미리 설정하고, 그 경로로만 데이터 전송
- TCP가 사용하는 방식.
- 연결을 먼저 설정(3-way handshake)하고, 데이터 전송 후 해제.
- 모든 패킷이 동일한 경로를 따라가며 순서가 보장됨.
- 장점: 신뢰성, 순서 보장
- 단점: 연결 설정/해제 오버헤드
### 데이터그램 패킷 교환 방식
<img width="756" height="548" alt="image" src="https://github.com/user-attachments/assets/eb3a13fb-9ca6-4229-a703-4e31e14df3be" />

> 각 패킷이 독립적으로 경로를 선택해 전달됨
- UDP가 사용하는 방식.
- 연결 설정 없이 바로 전송.
- 패킷 순서나 신뢰성 보장 없음. (VoIP, 실시간 스트리밍에 적합)
- 장점: 빠름, 단순
- 단점: 순서/신뢰성 보장 안 됨
### TCP 연결 성립 과정 (3-way Handshake)
<img width="683" height="653" alt="image" src="https://github.com/user-attachments/assets/2b1aa889-6471-411a-bea9-79dea296ee5d" />

- SYN – 클라이언트가 서버에 연결 요청 (시퀀스 번호(ISN) 전송)
- SYN + ACK – 서버가 요청 수락 응답 (서버가 자신의 ISN과, 클라이언트의 ISN에 +1한 값 두 개를 보내서 수락(ACK)한다.)
- ACK – 클라이언트가 수락 확인 (서버의 ISN에 +1을 한 값을 보내서 수락한다)
- → 연결 성립
### TCP 연결 해제 과정 (4-way Handshake)
<img width="569" height="352" alt="image" src="https://github.com/user-attachments/assets/49b82f11-587b-450b-afa1-2f113a5e3269" />

- 클라이언트 → FIN (이를 Active Close라고 함)
  - 클라이언트 상태: `ESTABLISHED → FIN_WAIT_1`
  - 서버 상태: `ESTABLISHED → CLOSE_WAIT`
- 서버 → ACK (하지만 서버는 아직 클라이언트에게 보낼 데이터가 남아있을 수 있음)
  - 클라이언트 상태: `FIN_WAIT_1 → FIN_WAIT_2`
  - 서버 상태: 여전히 ` CLOSE_WAIT`
- 서버 → FIN (서버도 이제 전송을 모두 마쳤음을 통보)
  - 서버 상태: `CLOSE_WAIT → LAST_ACK`
- 클라이언트 → ACK (클라이언트가 서버의 FIN을 수신하고 ACK로 응답)
  - 클라이언트 상태: `TIME_WAIT → CLOSED` (일정 시간 기다린 후 완전히 종료)
  - 서버 상태: `LAST_ACK → CLOSED`
- → 연결 종료
#### ⏳ TIME_WAIT 상태의 이유
> TIME_WAIT은 안전한 종료를 보장하기 위한 보호 단계다
- ① 지연 패킷(Late Packet) 방지
  - 어떤 패킷은 전송이 지연될 수 있다
  - 연결 종료 후 도착한 지연 패킷은 데이터 무결성을 손상시킬 수 있다. (이전 세션의 패킷이 그 다음 연결의 데이터로 오인)
- ② 연결 종료의 완전성 확인
  - 클라이언트는 마지막으로 ACK를 보냈지만, 이 ACK이 손실될 수도 있다.
  - 만약 이때 바로 닫아버리면, 서버는 LAST_ACK상태에서 계속 FIN을 재전송하기 때문에 자원이 낭비된다 (결국엔 타임아웃으로 종료)
## 인터넷 계층 (Internet Layer)
- **임무:** 출발지와 목적지 간의 **논리적 주소(IP)** 기반 **라우팅** 수행. (라우팅 = 목표까지 가는 최적 경로를 선택하는 행위)
- **대표 프로토콜:** IP, ICMP, ARP, RARP
- **데이터 단위:** 패킷(Packet)
- 비연결적이다. 신뢰성이나 순서 보장은 전송계층에서 한다.
### 핵심 프로토콜
<img width="814" height="259" alt="image" src="https://github.com/user-attachments/assets/c5218fba-b836-400e-a014-f8d05394338f" />

## 🔌링크 계층
- **임무:** 물리적으로 연결된 **같은 네트워크 내 노드 간 데이터 전송** 담당.
- **대표 프로토콜:** Ethernet(IEEE 802.3), Wi-Fi(IEEE 802.11)
- **데이터 단위:** 프레임(Frame)
- 데이터 링크 계층과 물리 계층으로 나누기도 한다
  - **데이터 링크 계층 :** MAC 주소 기반 프레임 전송 (에러 확인/흐름 제어/접근 제어)
  - **물리 계층 :** 0과 1을 전기신호/광신호로 변환
### 유선 LAN(IEEE802.3)
- 전송 방식: 이더넷 기반, MAC 주소로 통신.
- 전이중화 통신 사용 
#### 전이중화 통신 (Full Duplex)
<img width="649" height="375" alt="image" src="https://github.com/user-attachments/assets/c0d93a4a-8fb9-49c8-bb00-293345fe7a11" />

- 송수신이 동시에 가능. (예: 스위치 기반 LAN)
- 충돌(Collision)이 발생하지 않음.
- 송신로와 수신로를 따로 두기 때문
#### CSMA/CD (Carrier Sense Multiple Access / Collision Detection)
- 반이중화 통신, 패킷 충돌을 감지하고 재전송.
- 송신로와 수신로를 따로 두지 않고 한 경로로 통신해서 충돌
- 현재는 스위치 기반 구조로 거의 사용되지 않음 (허브 시절 기술).
### 🧵유선 LAN을 이루는 케이블
#### 트위스트 페어 케이블 (UTP/STP)
<img width="327" height="102" alt="image" src="https://github.com/user-attachments/assets/3b87e0f2-8948-46b9-90f5-ee4285373d47" />
<img width="635" height="175" alt="image" src="https://github.com/user-attachments/assets/e42525b9-3066-4502-a5b3-9e62517d6e3b" />

- 구리선 두 가닥을 꼬아서 전자파 간섭 최소화. (구리선 8가닥을 두 가닥씩 꼬아서 만든 케이블)
- Cat5e / Cat6 등으로 구분, 최대 1Gbps~10Gbps 전송 가능.
- UTP / STP 이렇게 두 종류가 있다.
  - UTP : 차폐(shield) 없음 → 우리가 집에서 흔히 쓰는 LAN 케이블
  - STP : 차폐(shield) 있음 → 전자파 간섭 줄이려고 금속 shielding 들어가는 LAN 케이블
#### 광섬유 케이블
<img width="576" height="287" alt="image" src="https://github.com/user-attachments/assets/ccb5dab9-c1fd-4b48-9e61-12c3a9691749" />

- 광섬유는 **빛(레이저)** 으로 데이터를 보낸다.
- 구리선 대비
  - **장거리 / 초고속** (= 감쇠가 훨씬 적다)
- 보통 **100Gbps** 급 전송 가능
- 내부 구조는
  - 굴절률 높은 부분: **Core**
  - 굴절률 낮은 부분: **Cladding**
- 빛이 Core 내부에서 **계속 전반사**되며 끝까지 간다
### 📡 무선 LAN (IEEE 802.11)
- 송수신에 같은 채널 사용 (반이중화 통신) 
#### 반이중화 통신 (Half Duplex)
<img width="662" height="376" alt="image" src="https://github.com/user-attachments/assets/de927bb8-1eeb-49c2-b22b-e80792823efe" />

- 한 번에 한 방향만 통신 가능
- 송신중에는 수신 불가
- 동시에 송신하면 출돌이 일어나므로, 충돌 방지 시스템이 필요 
#### CSMA/CA (Collision Avoidance)
- 충돌을 ‘예방’하기 위한 방식.
- 송신 전 채널 감시 + ACK 기반 재전송.
### 무선 LAN을 이루는 주파수
- 전파 주파수 대역(RF Band)을 이용한다
- 대표: 2.4GHz / 5GHz / (새로운) 6GHz
- 2.4GHz: 멀리 가지만 간섭 多
- 5GHz: 거리 짧지만 깔끔함(간섭 적고 채널 多 → 그래서 요즘 주력)
#### 와이파이
> 무선 LAN을 상호 호환 가능하게 표준화한 기술
- Wi-Fi 자체가 새로운 기술은 아니고, IEEE 802.11 규격을 기반으로 만든 상표 및 인증 규격이다.
- 즉, Wi-Fi = 802.11 무선 LAN을 호환되게 만든 브랜드 이름이다.
- 구성요소
  - **AP(Access Point)** : 무선 접속 장치, 흔히 말하는 “공유기” (유선 LAN 신호 ↔ 무선 LAN 신호 변환)
  - **STA(Station)** : 무선 단말기 (노트북, 스마트폰 등)
- <img width="562" height="330" alt="image" src="https://github.com/user-attachments/assets/a686135d-d9bb-470e-9751-398fb0d47254" />

#### BSS (Basic Service Set)
- **BSS**는 “기본 무선 서비스 집합”을 뜻한다.
- 하나의 AP(Access Point)와 그에 연결된 클라이언트들로 구성된다.
- 하나의 BSS는 **고유한 식별자(BSSID)** 를 가지며, **한정된 범위** 내에서만 통신 가능하다.
- 다른 BSS로 이동하면 연결이 끊기며, 새로운 연결 절차가 필요하다.
> 즉, 한 공유기 기준으로 묶인 무선 영역이 바로 “하나의 BSS”.
#### ESS (Extended Service Set)
- **ESS**는 여러 개의 BSS를 유선 백본이나 스위치로 연결해 만든 **확장형 무선 네트워크 그룹**이다.
- ESS에 속한 AP들은 **같은 SSID**를 공유하고,
- 사용자는 **로밍(roaming)** 을 통해 다른 AP로 이동해도 끊김 없이 연결 유지가 가능하다.
- 공항, 캠퍼스, 회사 사무실 같은 넓은 구역에서 Wi-Fi가途중에 끊기지 않는 이유가 바로 ESS 구조 때문이다.
### 이더넷 프레임
<img width="758" height="186" alt="image" src="https://github.com/user-attachments/assets/12b3f02f-7c08-44e9-ba26-81603274f45d" />

| 필드명                             |      크기      | 역할                                                     |
| :------------------------------ | :----------: | :----------------------------------------------------- |
| **Preamble**                    |    7 Byte    | 프레임 시작 신호. 수신 측이 타이밍 동기화하도록 도와줌                        |
| **SFD (Start Frame Delimiter)** |    1 Byte    | “이제부터 본격적으로 MAC 주소 시작된다”는 표시                           |
| **DMAC (Destination MAC)**      |    6 Byte    | 수신 장치의 MAC 주소 (목적지)                                    |
| **SMAC (Source MAC)**           |    6 Byte    | 송신 장치의 MAC 주소 (출발지)                                    |
| **EtherType**                   |    2 Byte    | 상위 프로토콜 식별 (예: IPv4=0x0800, IPv6=0x86DD, ARP=0x0806 등) |
| **Payload**                     | 46~1500 Byte | 실제 전송할 데이터(IP 패킷 등)                                    |
| **CRC (Frame Check Sequence)**  |    4 Byte    | 에러 검출용 비트 (오류 있으면 재전송 요청)                              |

1. Preamble (7B)
- 10101010 패턴 반복
- 수신 측 클럭을 맞추기 위한 ‘비트 동기화 신호’
- 실제 데이터가 오기 전에 “준비해라, 이제 간다”는 의미
2. SFD (1B)
- 10101011 패턴으로 끝나며,
- “이제부터 MAC 주소 시작”을 알려준다.
3. DMAC / SMAC
- LAN 내부 통신의 주소 체계
- 48비트(6바이트) 로 구성되어 있고, 각 네트워크 인터페이스 카드(NIC)에 고유하게 부여된다.
- DMAC는 목적지 장치, SMAC는 송신 장치.
- 예시:
  - DMAC: 00:1A:92:0A:7B:AC
  - SMAC: 00:1C:23:45:67:89
4. EtherType (2B)
- 상위 계층이 무엇인지를 나타냄.
- 즉 “Payload 안에 들어있는 데이터의 정체표”
- 예:
  - `0x0800` → IPv4
  - `0x86DD` → IPv6
  - `0x0806` → ARP
5. Payload
- 실제 전달할 내용.
- 일반적으로 IP 패킷이 들어간다.
- 크기는 46~1500B (MTU 제한 1500B).
- 너무 짧으면 Padding(채우기)을 붙인다.
6. CRC (4B)
- 전송 중 데이터가 손상됐는지 확인.
- 수신 측에서 다시 계산해 비교, 다르면 프레임 폐기.
## 계층 간 데이터 송수신 과정
### 캡슐화 과정
### 비캡슐화 과정
# PUD
